<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 at 2017-12-29 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20171229" />
    <meta http-equiv="Content-Language" content="en" />
    <title>JDBDT &#x2013; Database handles</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="./" id="bannerLeft">
                                                                                                <img src="images/jdbdt-logo.png"  alt="JDBDT"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="publishDate">Last Published: 2017-12-29
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 1.0.3
                      </li>
                      
              
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">JDBDT</li>
                              
      <li>
  
                          <a href="index.html" title="Home">
          <span class="none"></span>
        Home</a>
            </li>
                
      <li>
  
                          <a href="MIT_License.html" title="License">
          <span class="none"></span>
        License</a>
            </li>
                              <li class="nav-header">Reference</li>
                              
      <li>
  
                          <a href="Facade.html" title="API facade">
          <span class="none"></span>
        API facade</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>Database handles</a>
          </li>
                
      <li>
  
                          <a href="DataSources.html" title="Data sources">
          <span class="none"></span>
        Data sources</a>
            </li>
                
      <li>
  
                          <a href="DataSets.html" title="Data sets">
          <span class="none"></span>
        Data sets</a>
            </li>
                
      <li>
  
                          <a href="DBSetup.html" title="Database setup">
          <span class="none"></span>
        Database setup</a>
            </li>
                
      <li>
  
                          <a href="DBAssertions.html" title="Assertions">
          <span class="none"></span>
        Assertions</a>
            </li>
                
      <li>
  
                          <a href="Logs.html" title="Logging format">
          <span class="none"></span>
        Logging format</a>
            </li>
                
      <li>
  
                          <a href="Compatibility.html" title="Compatibility">
          <span class="none"></span>
        Compatibility</a>
            </li>
                
      <li>
  
                          <a href="apidocs/index.html" title="Javadoc">
          <span class="none"></span>
        Javadoc</a>
            </li>
                              <li class="nav-header">Tutorial</li>
                              
      <li>
  
                          <a href="Tutorial.html" title="Guide">
          <span class="none"></span>
        Guide</a>
            </li>
                
      <li>
  
                          <a href="http://github.com/edrdo/jdbdt-tutorial" class="externalLink" title="Code @ GitHub">
          <span class="none"></span>
        Code @ GitHub</a>
            </li>
                              <li class="nav-header">Development</li>
                              
      <li>
  
                          <a href="http://search.maven.org/#search%7Cga%7C1%7Cjdbdt" class="externalLink" title="Maven Central">
          <span class="none"></span>
        Maven Central</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/edrdo/jdbdt/" class="externalLink" title="Source code">
          <span class="none"></span>
        Source code</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/edrdo/jdbdt/issues/" class="externalLink" title="Issue tracker">
          <span class="none"></span>
        Issue tracker</a>
            </li>
                
      <li>
  
                          <a href="https://travis-ci.org/edrdo/jdbdt/" class="externalLink" title="Travis CI">
          <span class="none"></span>
        Travis CI</a>
            </li>
                
      <li>
  
                          <a href="https://ci.appveyor.com/project/edrdo/jdbdt" class="externalLink" title="AppVeyor CI">
          <span class="none"></span>
        AppVeyor CI</a>
            </li>
                
      <li>
  
                          <a href="https://sonarcloud.io/organizations/jdbdt/projects" class="externalLink" title="SonarCloud">
          <span class="none"></span>
        SonarCloud</a>
            </li>
                
      <li>
  
                          <a href="https://scan.coverity.com/projects/edrdo-jdbdt" class="externalLink" title="Coverity">
          <span class="none"></span>
        Coverity</a>
            </li>
                
      <li>
  
                          <a href="project-info.html" title="Maven reports">
          <span class="none"></span>
        Maven reports</a>
            </li>
                
      <li>
  
                          <a href="Inception.html" title="Inception">
          <span class="none"></span>
        Inception</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Database handles</h1>
<p>A database handle encapsulates access to a database connection.</p>
<p>&#160;<a name="Creation"></a></p>
<div class="section">
<h2><a name="Creation_and_teardown"></a>Creation and teardown</h2>
<p>A database handle is created using the <tt>database</tt> facade method, for instance supplying as argument a database URL. Once the database handle is no longer required, internal resources may be freed up using the <tt>teardown</tt> method.</p>
<p><i>Illustration</i></p>

<div class="source">
<div class="source"><pre class="prettyprint">import static org.jdbdt.JDBDT.*;
import org.jdbdt.DB; 
import java.sql.Connection;
import java.sql.DriverManager;
...
// Creation
String dbURL = ...;
DB dbHandle = database(&quot;jdbc:myFaveDBEngine://myDB&quot;);
...
// Tear-down.
// The second parameter indicates if the underlying 
// JDBDT connection should be closed or kept open.
// In this case we close the connection.
teardown(db, true);
</pre></div></div>
<p>&#160;<a name="Configuration"></a></p></div>
<div class="section">
<h2><a name="Configuration"></a>Configuration</h2>
<p>Database handle options are defined by the <tt>DB.Option</tt> enumeration. They may be enabled and disabled using <tt>enable</tt> and <tt>disable</tt>, respectively. The available options relate to logging and a few other features discussed below. </p>
<p><i>Illustration</i></p>

<div class="source">
<div class="source"><pre class="prettyprint">import static org.jdbdt.JDBDT.*;
import org.jdbdt.DB;
import org.jdbdt.DB.Option;
...
DB db = database(...);
db.enable(Option.LOG_SETUP);
</pre></div></div>
<p><a name="Logging"></a></p>
<div class="section">
<h3><a name="Logging"></a>Logging</h3>
<p>For debugging purposes or report generation, trace output may be written to a <a href="Logs.html">log file</a>. The following logging options are defined in <tt>DB.Option</tt></p>

<ul>
  
<li><tt>LOG_ASSERTION_ERRORS</tt>: log failed assertions;</li>
  
<li><tt>LOG_ASSERTIONS</tt>: log all assertions (passed or failed);</li>
  
<li><tt>LOG_QUERIES</tt>: log the result of database queries;</li>
  
<li><tt>LOG_SETUP</tt>: log database setup operations (data set insertions and SQL setup commands);</li>
  
<li><tt>LOG_SNAPSHOTS</tt>: log database snapshots.</li>
</ul>
<p>At creation time, only the <tt>DB.Option.LogAssertionErrors</tt> option is enabled by default, and the log output is redirected to <tt>System.err</tt>. Subsequently, logging options may be enabled/disabled using <tt>enable</tt> / <tt>disable</tt> and the output log may be changed using <tt>setLog</tt>. A call to <tt>enableFullLogging()</tt> enables all logging options at once.</p>
<p><i>Illustration</i></p>

<div class="source">
<div class="source"><pre class="prettyprint">import static org.jdbdt.JDBDT.*;
import org.jdbdt.DB;
import org.jdbdt.Log;
...
DB db = database(...);

// Write log output to a file
db.setLog(new File(&quot;MyLog.jdbdt.xml&quot;));

// Enable all logging options
db.enableFullLogging();
</pre></div></div>
<p>Note that if you use a <tt>.gz</tt> extension for log files, they will be GZIP-compressed and have a much smaller in size, e.g.,</p>

<div class="source">
<div class="source"><pre class="prettyprint">db.setLog(new File(&quot;MyLog.jdbdt.xml.gz&quot;));
</pre></div></div>
<p><a name="StatementReuse"></a></p></div>
<div class="section">
<h3><a name="Statement_reuse"></a>Statement reuse</h3>
<p>A database handle internally reuses <tt>java.sql.PreparedStatement</tt> objects to avoid re-compiling SQL code, regardless of any statement pooling in place for the JDBC driver in use, The scheme is enabled by default and it should generally provide a little more efficiency and cause no problems. For drivers that do not deal well with statement reuse, however, the <tt>REUSE_STATEMENTS</tt> option should be disabled as follows:</p>
<p><i>Illustration</i></p>

<div class="source">
<div class="source"><pre class="prettyprint">import static org.jdbdt.JDBDT.*;
import org.jdbdt.DB;
import org.jdbdt.DB.Option;
...
DB db = database(...);
db.disable(Option.REUSE_STATEMENTS)
</pre></div></div>
<p><b>Known issue</b>: statement reuse should be disabled for <a href="Compatibility.html#KnownIssues">xerial&#x2019;s JDBC driver for sqlite</a>. No problems were detected for <a href="Compatibility.html#Drivers">all other JDBC drivers tested in the JDBDT build</a>.</p>
<p><a name="BatchUpdates"></a></p></div>
<div class="section">
<h3><a name="Batch_updates"></a>Batch updates</h3>
<p>The <tt>BATCH_UPDATES</tt> option indicates that database insertions should use the JDBC batch update mechanism, unless the JDBC driver in does not support this feature (in this case the option will have no effect). The option is enabled by default.</p>
<p><a name="SummaryOfMethods"></a></p></div></div>
<div class="section">
<h2><a name="Summary_of_API_methods"></a>Summary of API methods</h2>
<div class="section">
<h3><a name="JDBDT"></a><tt>JDBDT</tt></h3>

<ul>
  
<li><tt>database(c)</tt> creates a handle for database connection <tt>c</tt>.</li>
  
<li><tt>database(url)</tt> creates a handle for the given database URL.</li>
  
<li><tt>database(url, user, pass)</tt> creates a handle for the given database URL, user name, and password.</li>
  
<li><tt>teardown(db, closeConn)</tt> frees up internal resources used by <tt>db</tt>, and also closes the underlying database connection if <tt>closeConn == true</tt>.</li>
</ul></div>
<div class="section">
<h3><a name="DB"></a><tt>DB</tt></h3>

<ul>
  
<li><tt>getConnection()</tt> returns the connection associated to the handle.</li>
  
<li><tt>enable(o1, o2, ...)</tt> enables given options.</li>
  
<li><tt>disable(o1, o2, ...)</tt> disables given options.</li>
  
<li><tt>isEnabled(o)</tt> tests if option <tt>o</tt> is enabled.</li>
  
<li><tt>enableFullLogging()</tt> enables all logging options.</li>
  
<li><tt>setLog(out)</tt> redirects log output to <tt>out</tt>, a <tt>java.io.File</tt> or <tt>java.io.PrintStream</tt>.</li>
  
<li><tt>setMaximumBatchUpdateSize(n)</tt> sets <tt>n</tt> as the maximum number of operations in a batch update.</li>
  
<li><tt>getMaximumBatchUpdateSize()</tt> gets the current setting for the maximum number of operations in a batch update.</li>
</ul></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                    2016&#x2013;2017
                        <a href="http://jdbdt.org">JDBDT</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
